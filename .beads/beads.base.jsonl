{"id":"tygor-9kb","content_hash":"430774ce5ea38249bb30527f459fa8f66db8f635f5997c35f64cb63fbbb23955","title":"Implement Generator Interface Specification v0.16.2","description":"Replace tygo dependency with native generator implementation following doc/GENERATOR_INTERFACE_SPEC.md. Target 95%+ test coverage.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-27T09:03:40.498577462-05:00","updated_at":"2025-11-27T11:40:33.168385158-05:00","closed_at":"2025-11-27T11:40:33.168385158-05:00","source_repo":"."}
{"id":"tygor-9kb.1","content_hash":"8c6328495febea09c4e124836e2f44ab8b9acd4501d1d3ae166735b74b5865de","title":"Phase 1: Core IR Types (Foundation)","description":"Implement Intermediate Representation types in tygorgen/ir package: GoIdentifier, Documentation, Source, Warning, PackageInfo, DescriptorKind, PrimitiveKind, TypeDescriptor interface, all named type descriptors (Struct, Alias, Enum), all expression type descriptors (Primitive, Array, Map, Reference, Ptr, Union, TypeParameter), Service/Endpoint descriptors, and Schema. Include comprehensive unit tests.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T09:03:47.941883823-05:00","updated_at":"2025-11-27T09:10:56.627178333-05:00","closed_at":"2025-11-27T09:10:56.627178333-05:00","source_repo":"."}
{"id":"tygor-9kb.2","content_hash":"2dac463359917681faedb8f2a0c1d0b0323bc561b563246bd2b8fa4f12c7e9de","title":"Phase 2: Output Sinks","description":"Implement OutputSink interface and implementations in tygorgen/sink package: OutputSink interface, FilesystemSink (with atomic writes, path traversal protection), MemorySink (thread-safe), ValidatePath helper. Include tests for all operations.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T09:04:17.39073209-05:00","updated_at":"2025-11-27T10:58:24.823329949-05:00","closed_at":"2025-11-27T10:58:24.823329949-05:00","source_repo":".","dependencies":[{"issue_id":"tygor-9kb.2","depends_on_id":"tygor-9kb.1","type":"blocks","created_at":"2025-11-27T09:04:26.392835465-05:00","created_by":"daemon"}]}
{"id":"tygor-9kb.3","content_hash":"af30b55a821ef34e8373c021dd2be9e17789403a18d2fdff9b2508d515c356d6","title":"Phase 3: Reflection Provider","description":"Implement ReflectionProvider in tygorgen/provider package: BuildSchema using reflect, type extraction (structs, tags, fields), special type handling ([]byte, time.Time, etc), generic instantiation handling, anonymous struct handling, embedding rules, error handling for unmarshalable types. Start with this to validate IR design.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T09:04:17.4765084-05:00","updated_at":"2025-11-27T11:10:22.555332046-05:00","closed_at":"2025-11-27T11:10:22.555332046-05:00","source_repo":".","dependencies":[{"issue_id":"tygor-9kb.3","depends_on_id":"tygor-9kb.1","type":"blocks","created_at":"2025-11-27T09:04:26.473146399-05:00","created_by":"daemon"}]}
{"id":"tygor-9kb.4","content_hash":"55cf66592c1e3ba26a6ab7e21c932051ea09336360d78fdf3a79f3640fb91699","title":"Phase 4: Source Provider","description":"Implement SourceProvider in tygorgen/provider package using go/types: package loading, type extraction with docs/source locations, enum detection from const blocks, full generic type handling (preserve type parameters), custom marshaler detection. Primary provider with full feature set.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T09:04:17.563529332-05:00","updated_at":"2025-11-27T11:12:07.892482711-05:00","closed_at":"2025-11-27T11:12:07.892482711-05:00","source_repo":".","dependencies":[{"issue_id":"tygor-9kb.4","depends_on_id":"tygor-9kb.1","type":"blocks","created_at":"2025-11-27T09:04:26.552662909-05:00","created_by":"daemon"}]}
{"id":"tygor-9kb.5","content_hash":"c868b03d44af17180f8483730169fefad2199f46862480bc1ee997014b7f7395","title":"Phase 5: Generator Interface \u0026 TypeScript Generator","description":"Implement Generator interface and TypeScript generator: Generator interface, GenerateOptions, GenerateResult, TypeEmitter infrastructure, TypeScriptGenerator (struct-\u003einterface, alias, enum styles, primitives, nullable/optional mapping per §4.9), reserved word escaping, JSDoc formatting, manifest generation.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T09:04:17.656912823-05:00","updated_at":"2025-11-27T11:31:44.731920743-05:00","closed_at":"2025-11-27T11:31:44.731920743-05:00","source_repo":".","dependencies":[{"issue_id":"tygor-9kb.5","depends_on_id":"tygor-9kb.2","type":"blocks","created_at":"2025-11-27T09:04:26.636274429-05:00","created_by":"daemon"},{"issue_id":"tygor-9kb.5","depends_on_id":"tygor-9kb.3","type":"blocks","created_at":"2025-11-27T09:04:26.644688264-05:00","created_by":"daemon"},{"issue_id":"tygor-9kb.5","depends_on_id":"tygor-9kb.4","type":"blocks","created_at":"2025-11-27T09:04:26.652084952-05:00","created_by":"daemon"}]}
{"id":"tygor-9kb.6","content_hash":"7a5715a9abb2b43d0be9e1c060d556ae45c0d88d3ccf9c145c00dcbe447686a1","title":"Phase 6: Integration \u0026 Migration","description":"Update tygorgen.Generate() to use new system, maintain backward compatibility, remove tygo dependency, update documentation. Final integration testing.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T09:04:17.752418591-05:00","updated_at":"2025-11-27T11:37:55.161325365-05:00","closed_at":"2025-11-27T11:37:55.161325365-05:00","source_repo":".","dependencies":[{"issue_id":"tygor-9kb.6","depends_on_id":"tygor-9kb.5","type":"blocks","created_at":"2025-11-27T09:04:26.730265508-05:00","created_by":"daemon"}]}
{"id":"tygor-if8","content_hash":"4378ee78fe4c341489f04ccb0fac69daaf07eddf7121eff8cd66dca77dde0a7e","title":"Handle same-name types from different packages in TypeScript generation","description":"Currently the TypeScript generator only uses the type name without package qualification:\n\n```go\nfunc (e *Emitter) emitReference(r *ir.ReferenceDescriptor) string {\n    typeName := applyNameTransforms(r.Target.Name, e.config)  // Ignores Package\n    return escapeReservedWord(typeName)\n}\n```\n\nThis causes collisions when:\n1. Same type name from different packages: `v1.User` and `v2.User` both become `User`\n2. Same package name but different paths: `github.com/foo/types.User` and `github.com/bar/types.User`\n\n**Solution**: Always qualify types from external packages using import path disambiguation.\n\n**Approach**:\n- Track all types in schema by package\n- Detect when multiple packages contribute types\n- For types from packages other than the \"main\" package, prefix with sanitized package path\n- Handle same-package-name collision by using more of the import path\n\n**Example output**:\n```typescript\n// From github.com/foo/api/v1\nexport interface api_v1_User { ... }\n\n// From github.com/foo/api/v2  \nexport interface api_v2_User { ... }\n\n// References use qualified names\nexport interface Request {\n  old_user: api_v1_User;\n  new_user: api_v2_User;\n}\n```\n\nThe IR already has `GoIdentifier.Package` - just need to use it.","status":"in_progress","priority":1,"issue_type":"bug","created_at":"2025-11-27T12:29:12.745384057-05:00","updated_at":"2025-11-27T12:38:06.413181293-05:00","source_repo":".","comments":[{"id":1,"issue_id":"tygor-if8","author":"cbro","text":"## Refined Approach\n\nAdd `StripPackagePrefix` config option. Types are qualified with their package path minus the prefix.\n\n**Config:**\n```go\ntype GeneratorConfig struct {\n    // StripPackagePrefix removes this prefix from package paths when qualifying type names.\n    // Example: \"github.com/broady/tygor/\" makes \"github.com/broady/tygor/api/v1.User\" → \"api_v1_User\"\n    StripPackagePrefix string\n}\n```\n\n**Behavior:**\n1. Main package types (matching Schema.Package): bare names\n2. Other packages: qualify with `sanitize(packagePath - StripPackagePrefix) + \"_\" + typeName`\n\n**Examples with `StripPackagePrefix: \"github.com/broady/tygor/\"`:**\n\n| Go Type | TypeScript |\n|---------|------------|\n| `api.User` (main pkg) | `User` |\n| `github.com/broady/tygor/api/v1.User` | `api_v1_User` |\n| `github.com/broady/tygor/api/v2.User` | `api_v2_User` |\n| `github.com/broady/tygor/common.Config` | `common_Config` |\n| `github.com/other/lib.Helper` | `github_com_other_lib_Helper` |\n\nStable, predictable, user-controlled.","created_at":"2025-11-27T17:37:02Z"}]}
